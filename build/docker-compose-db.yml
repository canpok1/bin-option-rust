version: '3'
services:
  db:
    image: mariadb:10.8
    container_name: bin-option-db
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: T4g5Ucs6
      MYSQL_DATABASE: bin-option
      MYSQL_USER: service-user
      MYSQL_PASSWORD: P@ssw0rd
    volumes:
      - bin-option-db-store:/var/lib/mysql
    ports:
      - "13306:3306"
  flyway:
    image: flyway/flyway
    container_name: bin-option-flyway
    command: -url=jdbc:mysql://db/bin-option -user=root -password=T4g5Ucs6 -connectRetries=60 migrate
    volumes:
      - ./ddl:/flyway/sql
    depends_on:
      - db
volumes:
  bin-option-db-store:
